{% extends 'base.html' %}
{% load static %}

{% block title %}Reservas{% endblock %}
{% block extrastatic %}<link rel="stylesheet" href="{% static 'reserva/css/listar_reservas.css' %}"/>{% endblock %}
{% block content %}
 <h1>Reservas</h1>
  <a class="btn btn-primary" href="{% url 'agregar_reserva' %}">Agregar Reserva</a>
    {%if reservas %}
     <div class="object_container">
        {% regroup reservas by fecha_reserva as dates_items%}
        {% for date in dates_items %}
        <div class="each-day">
            <div>
                <h3 class="changelog-heading"><b>{{ date.grouper|date:"l d"  }} de {{ date.grouper|date:"F"  }}</b></h3>
            </div>
            {% for reserva in date.list %}
            <div oncontextmenu="openMenu('a{{reserva.id}}',event);return false;">
                <p>{{ reserva.hora_reserva }} - {{ reserva.detalle_reserva }}</p>
                <div class="menu" id="a{{reserva.id}}">
                    <div class="menu-item" onclick="location.href='{% url 'anular_reserva' reserva.id %}';"; style="cursor: pointer;">
                        <p><i class="fas fa-times"></i> Anular Hora</p>
                    </div>
                    <div class="menu-item" onclick="location.href='{% url 'cambiar_reserva' reserva.id %}';"; style="cursor: pointer;">
                        <p><i class="fas fa-edit"></i> Cambiar Hora</p>
                    </div>
                </div>
            </div>
            <script>
            $(":not(#a{{reserva.id}})").click(function() {
                $("#a{{reserva.id}}").hide();
            });

            </script>
            {% endfor %}
        </div>
        {% endfor %}
        
        {% else %}
        <h3>No hay reservas de hora vigentes</h3>
        {% endif %}
        <script src="{% static 'reserva/js/listar_reservas.js' %}"></script>
{% endblock %}